<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>Secret Keeper | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢</title>

    <style>
      :root {
        --primary: #4caf50;
        --primary-hover: #45a049;
        --disabled: #ccc;
        --text-muted: #666;
        --error: #cc0000;
        --bg: #fafafa;
      }

      html {
        -webkit-text-size-adjust: 100%;
      }

      body {
        font-family: "Roboto", Arial, sans-serif;
        padding: 20px;
        margin: 0 auto;
        background-color: var(--bg);
        color: #222;
      }

      .container {
        max-width: 640px;
        margin: 0 auto;
      }

      h3 {
        text-align: center;
        color: #222;
        margin-bottom: 8px;
      }

      .hint {
        font-size: 0.85em;
        color: var(--text-muted);
        margin-top: 2px;
      }

      label {
        display: block;
        margin-top: 14px;
        font-weight: 600;
      }

      input,
      textarea {
        width: 100%;
        padding: 12px;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 6px;
        margin-top: 4px;
        font-size: 15px;
        background-color: #fff;
      }

      textarea {
        resize: vertical;
        min-height: 120px;
      }

      button {
        margin-top: 24px;
        padding: 14px 20px;
        background-color: var(--primary);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        width: 100%;
        font-size: 17px;
        transition: background-color 0.2s ease, opacity 0.2s ease;
      }

      button:hover {
        background-color: var(--primary-hover);
      }

      button:disabled {
        background-color: var(--disabled);
        cursor: not-allowed;
        opacity: 0.8;
      }

      #status {
        margin-top: 20px;
        font-weight: bold;
        text-align: center;
        line-height: 1.6;
      }

      .alert {
        background-color: #fff3cd;
        border: 1px solid #ffeeba;
        padding: 10px 14px;
        border-radius: 6px;
        color: #856404;
        font-size: 0.9em;
        margin-bottom: 16px;
      }

      #countdownBox {
        margin-top: 16px;
        text-align: center;
        font-size: 0.95em;
        color: #444;
      }

      #cancelBtn {
        margin-top: 8px;
        padding: 6px 12px;
        background-color: #bbb;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      #cancelBtn:hover {
        background-color: #999;
      }

      @media (max-width: 600px) {
        body {
          padding: 14px;
          max-width: 100%;
        }

        input,
        textarea,
        button {
          font-size: 16px;
        }

        h3 {
          font-size: 20px;
          line-height: 1.3;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h3>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‚Äú‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‚Äù (Secret Keeper)</h3>

      <div class="alert">
        ‚ö†Ô∏è <b>‡∏Ç‡πâ‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</b> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Google Account ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ
      </div>

      <div>
        <label for="vaultTitle">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‚Äú‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‚Äù</label>
        <input
          id="vaultTitle"
          placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏¥‡∏ô‡∏±‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏â‡∏ö‡∏±‡∏ö‡∏ó‡∏µ‡πà 2 ‚Äî ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ Google Doc"
        />

        <label for="secretContent">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å)</label>
        <textarea
          id="secretContent"
          placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á, ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç, ‡∏Ñ‡∏≥‡∏ö‡∏≠‡∏Å‡∏•‡∏≤ ‚Äî ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÉ‡∏ô Google Docs"
        ></textarea>
        <div class="hint">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Doc ‡πÉ‡∏´‡∏°‡πà</div>

        <label for="filesFolderUrlOrId">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏£‡∏∑‡∏≠ ID ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö (PDF, ‡∏£‡∏π‡∏õ, ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠)</label>
        <input
          id="filesFolderUrlOrId"
          placeholder="‡∏ß‡∏≤‡∏á Google Drive URL ‡∏´‡∏£‡∏∑‡∏≠ ID ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå"
        />
        <div class="hint">
          ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)
        </div>

        <label for="trustees">Trusted E-Mail contacts</label>
        <input id="trustees" placeholder="b@example.com, c@example.com" />
        <div class="hint">‡πÉ‡∏™‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ ,)</div>

        <label for="checkinDays">Check-in interval (‡∏ß‡∏±‡∏ô)</label>
        <input id="checkinDays" type="number" value="1" min="1" />
        <div class="hint">‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Å‡∏≠‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å ‡πÜ ‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ô?</div>

        <label for="graceHours">Grace period (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</label>
        <input id="graceHours" type="number" value="12" min="1" />
        <div class="hint">
          ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ú‡πà‡∏≠‡∏ô‡∏ú‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ä‡πá‡∏Å‡∏≠‡∏¥‡∏ô ‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á e-mail ‚Äú‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‚Äù
        </div>

        <button id="createBtn" onclick="submitForm()">
          ‚è≥ Create Vault : ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢
        </button>

        <div id="status"></div>
        <div id="countdownBox"></div>
      </div>
    </div>

    <script>
      let countdownTimer;
      let countdownRemaining = 20;

      function submitForm() {
        const btn = document.getElementById("createBtn");
        const statusEl = document.getElementById("status");
        const countdownBox = document.getElementById("countdownBox");

        // Disable button while processing
        btn.disabled = true;
        statusEl.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Vault ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö... ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà";
        statusEl.style.color = "#ff9800";
        countdownBox.innerHTML = "";

        const data = {
          vaultTitle: document.getElementById("vaultTitle").value.trim(),
          secretContent: document.getElementById("secretContent").value.trim(),
          filesFolderUrlOrId: document.getElementById("filesFolderUrlOrId").value.trim(),
          trusteesCSV: document.getElementById("trustees").value.trim(),
          checkinDays: document.getElementById("checkinDays").value.trim(),
          graceHours: document.getElementById("graceHours").value.trim(),
        };

        google.script.run
          .withSuccessHandler(function (resp) {
            if (resp.ok) {
              // Success message
              let msg =
                "‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Vault ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br><a href='" +
                resp.docUrl +
                "' target='_blank'>‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å</a>";
              if (resp.filesFolderUrl) {
                msg +=
                  "<br><a href='" +
                  resp.filesFolderUrl +
                  "' target='_blank'>‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</a>";
              }
              statusEl.innerHTML =
                msg + "<br><br>‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô <b>20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</b>";
              statusEl.style.color = "#4caf50";

              // üîí Prevent future clicks permanently
              btn.disabled = true;
              btn.textContent = "‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß";

              startCountdown();
            } else {
              btn.disabled = false;
              statusEl.textContent =
                "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " +
                (resp.error || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á Vault ‡πÑ‡∏î‡πâ");
              statusEl.style.color = "#cc0000";
            }
          })
          .withFailureHandler(function (err) {
            btn.disabled = false;
            statusEl.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö: " + err.message;
            statusEl.style.color = "#cc0000";
          })
          .submitVault(data);
      }

      function startCountdown() {
        const countdownBox = document.getElementById("countdownBox");
        countdownRemaining = 20;

        function updateCountdown() {
          countdownBox.innerHTML =
            "‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô <b>" +
            countdownRemaining +
            "</b> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ<br><button id='cancelBtn' onclick='cancelCountdown()'>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î</button>";

          countdownRemaining--;
          if (countdownRemaining < 0) {
            clearInterval(countdownTimer);
            window.close(); // ‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö (‡∏ñ‡πâ‡∏≤‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï)
          }
        }

        updateCountdown();

        // smooth auto-scroll so the countdown (and success message) comes into view on mobile
        try {
          // small timeout helps in some browsers to allow layout first
          setTimeout(function () {
            countdownBox.scrollIntoView({ behavior: "smooth", block: "end" });
          }, 60);
        } catch (e) {
          // fallback
          window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
        }

        countdownTimer = setInterval(updateCountdown, 1000);
      }

      function cancelCountdown() {
        clearInterval(countdownTimer);
        const countdownBox = document.getElementById("countdownBox");
        countdownBox.innerHTML =
          "‚è∏ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠";
      }
    </script>
  </body>
</html>
